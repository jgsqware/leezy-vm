{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/main/.schema/devbox.schema.json",
  "packages": [
    "lima@latest",
    "gum@latest"
  ],
  "env": {
    "LIMA_INSTANCE": "leezy-vm"
  },
  "shell": {
    "init_hook": [
      "gum style --foreground 212 --border-foreground 212 --border double --align center --width 50 --margin '1 2' --padding '2 4' 'üì¶ Leezy VM (Lima)' 'Devbox Environment Loaded'",
      "echo ''",
      "if [ ! -f .env ]; then",
      "  gum style --foreground 214 '‚ö†Ô∏è  No .env file found. Creating from template...'",
      "  cp .env.example .env",
      "  gum style --foreground 46 '‚úÖ Created .env file.'", 
      "  gum style --foreground 214 'Please edit .env and add your TAILSCALE_AUTH_KEY'",
      "  echo ''",
      "fi",
      "gum style --foreground 117 --bold 'Available commands:'",
      "echo ''",
      "gum style --foreground 183 '  devbox run start     - Start the Lima VM'",
      "gum style --foreground 183 '  devbox run connect   - Connect to the VM'", 
      "gum style --foreground 183 '  devbox run stop      - Stop the VM'",
      "gum style --foreground 183 '  devbox run status    - Check VM status'",
      "gum style --foreground 183 '  devbox run destroy   - Remove the VM'",
      "echo ''",
      "if limactl list 2>/dev/null | grep -q leezy-vm; then",
      "  gum style --foreground 46 --bold 'VM Status:'",
      "  limactl list leezy-vm",
      "else",
      "  gum style --foreground 214 'VM is not running. Run: devbox run start'",
      "fi"
    ],
    "scripts": {
      "setup": [
        "gum style --foreground 117 --bold 'Setting up environment...'",
        "cp .env.example .env",
        "gum style --foreground 46 '‚úÖ Created .env file'",
        "gum style --foreground 214 'Please edit .env and add your TAILSCALE_AUTH_KEY'"
      ],
      "start": [
        "gum style --foreground 117 --bold 'Starting Leezy VM...'",
        "gum spin --spinner dot --title 'Loading environment variables...' -- sleep 1",
        "if [ -f .env ]; then",
        "  set -a",
        "  source .env", 
        "  set +a",
        "  gum style --foreground 46 '‚úÖ Environment loaded'",
        "else",
        "  gum style --foreground 214 '‚ö†Ô∏è  No .env file found'",
        "fi",
        "gum spin --spinner dot --title 'Starting Lima VM...' -- limactl start --name=leezy-vm lima-leezy-vm.yaml",
        "echo ''",
        "gum style --foreground 46 --border-foreground 46 --border rounded --padding '1 2' '‚úÖ VM Started Successfully!'",
        "echo ''",
        "gum style --foreground 183 'To connect: devbox run connect'",
        "gum style --foreground 183 'TinyProxy: http://localhost:8888'"
      ],
      "stop": [
        "gum style --foreground 214 --bold 'Stopping Lima VM...'",
        "gum spin --spinner dot --title 'Stopping VM...' -- limactl stop leezy-vm",
        "gum style --foreground 46 '‚úÖ VM stopped'"
      ],
      "destroy": [
        "gum confirm --default=false 'Are you sure you want to destroy the VM?' || exit 0",
        "gum style --foreground 196 --bold 'Destroying Lima VM...'",
        "gum spin --spinner dot --title 'Destroying VM...' -- limactl delete leezy-vm --force",
        "gum style --foreground 46 '‚úÖ VM destroyed'"
      ],
      "connect": [
        "gum style --foreground 117 --bold 'Connecting to Lima VM...'",
        "limactl shell leezy-vm"
      ],
      "status": [
        "gum style --foreground 117 --bold 'VM Status:'",
        "limactl list leezy-vm"
      ],
      "logs": [
        "gum style --foreground 117 --bold 'SSH Connection Info:'",
        "limactl show-ssh leezy-vm"
      ],
      "tailscale-status": [
        "gum style --foreground 117 --bold 'Tailscale Status:'",
        "limactl shell leezy-vm sudo tailscale status"
      ],
      "tailscale-up": [
        "gum style --foreground 117 --bold 'Authenticating Tailscale...'",
        "limactl shell leezy-vm sudo tailscale up"
      ]
    }
  }
}